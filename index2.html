<!DOCTYPE html>
<html>
  <head></head>
  <body>

<h1>Testing secure payment and username retrival from database</h1>
    
<p style="text-align: center;"></p>
<label>Enter and leave the payAccess key to unlock Observations 5-21:</label><input id="username" type="text" value="" placeholder="username" rows="1" cols="50" style='text-align: center; width: 400px;'>
<button id="submit_username" onclick="submit_username()" style="display:block">submit_username</button>
<br>
<div id="notification"></div>
<div id="error"></div>
<div id="response"></div>

<!-- Insert library_window_crypto_subtle.js CDN library HERE  -->
<script type="module" src="./index.js"></script>

<!-- --------------------------------------------------- -->
    
<script>

// ------------------------------------------------
  
window.addEventListener('beforeunload', function() {
    window.location.href = window.location.href + '?nocache=' + new Date().getTime();
});
  
// ------------------------------------------------

async function submit_username() {
	
	var RepoAobj = {};
  
	RepoAobj.repoOwner = "CodeSolutions2";
	RepoAobj.filename = "cb.txt";
	RepoAobj.repoA_name = "frontend_backend_message_passing_central_repository_v1"; // normally this would be a different repository
	RepoAobj.repoB_name = "frontend_backend_message_passing_central_repository_v1";
	RepoAobj.call_type = "insert_username";  // File database functions: insert_username, comparator_username_search
	RepoAobj.input_text = document.getElementById("username").value+"|"+RepoAobj.call_type;
	RepoAobj.foldername = "webappb";
  
	const obj = await encrypt_decrypt_a_file_database(RepoAobj);

	document.getElementById("response").innerHTML = "Your entered username: "+document.getElementById("username").value+", is "+obj.query0_result+" in the file database. ";
	
	if (RepoAobj.call_type == "insert_username") {
		document.getElementById("response").innerHTML += obj.query1_result;
	}
		
}
    
// ------------------------------------------------



  
    
  </script>

  </body>
</html>
